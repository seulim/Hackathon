@using System.Web.Mvc.Html;
@using System.Web.Mvc;
@using GMKT.GMobile.Web.Models;
@using GMKT.GMobile.Constant;
@using GMobile.Data.EventZone;
@using GMobile.Service.EventZone;
@using Arche.Data.Voyager;
@using GMKT.Framework.EnterpriseServices;
@using System.Text;
@using Newtonsoft.Json;
@using GMKT.Framework.Security;
@using Newtonsoft.Json.Linq;
@using GMKT.GMobile.Util;
@using GMKT.GMobile.Constant;


@functions {    
	public string GetJsonStringFromAction(string route_url)
	{
		try
		{
			StringBuilder sb = new StringBuilder();
			byte[] buf = new byte[1024];

			HttpWebRequest request = (HttpWebRequest)WebRequest.Create(route_url);
			HttpWebResponse response = (HttpWebResponse)request.GetResponse();

			Stream stream = response.GetResponseStream();
			string temp = null;
			int count = 0;

			do
			{
				count = stream.Read(buf, 0, buf.Length);

				if (count != 0)
				{
					temp = Encoding.UTF8.GetString(buf, 0, count);
					sb.Append(temp);
				}
			}
			while (count > 0);

			return sb.ToString().Trim();
		}
		catch (Exception ex)
		{

		}

		return string.Empty;
	}

	public string CreateEventCookie(string eid, bool double_true_single_false)
	{
		string cust_no = Model.MyProfile.CustNo;

		string s127 = GMKT.Framework.Constant.GMKTConstants.Hex7F;
		string time = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss");

		string s1 = GMKTCryptoLibrary.AesGCryptoEncrypt(
			time + s127 + eid + s127 + cust_no + s127 + time + s127
		);

		string s2 = GMKTCryptoLibraryOption.MD5(s1 + Model.CRYPT_MD5_FOOTER);

		if (double_true_single_false)
		{
			return @"""" + s1 + @""", """ + s2 + @"""";
		}
		else
		{
			return @"'" + s1 + "', '" + s2 + @"'";
		}
	}

	// 
	public int CheckEventApplyCount(string timestamp_dt, string eid1, string eid2, string eid3, string eid4)
	{
		if (PageAttr.IsLogin == true)
		{
			eid1 = GMKTCryptoLibraryOption.EncodeTo64(GMKTCryptoLibraryOption.DesEncrypt(eid1, Model.CRYPT_MD5_FOOTER));
			eid2 = GMKTCryptoLibraryOption.EncodeTo64(GMKTCryptoLibraryOption.DesEncrypt(eid2, Model.CRYPT_MD5_FOOTER));
			eid3 = GMKTCryptoLibraryOption.EncodeTo64(GMKTCryptoLibraryOption.DesEncrypt(eid3, Model.CRYPT_MD5_FOOTER));
			eid4 = GMKTCryptoLibraryOption.EncodeTo64(GMKTCryptoLibraryOption.DesEncrypt(eid4, Model.CRYPT_MD5_FOOTER));

			string json = GetJsonStringFromAction(Urls.MobileWebUrl + "/" + Url.Action("MyBenefitVip_CheckEventApplyCount")
	+ "?cust_no=" + Model.MyProfile.CustNo + "&timestamp_dt=" + timestamp_dt
	 + "&eid1=" + eid1 + "&eid2=" + eid2 + "&eid3=" + eid3 + "&eid4=" + eid4);


			if (!json.Equals(string.Empty))
			{
				JObject o = JObject.Parse(json);
				if (o != null)
				{
					return Convert.ToInt32(o["ret_value"].ToString());
				}
			}
		}

		return 0;
	}
}

@model MyBenefitVipM

@* 배너링크********************** *@

@{         
	JArray anyone_gift = Model.BannerCollection;
	JArray amount_gift = Model.GiftCollection;

	bool SVIP_OR_VIP = false;

	if (Model.MyProfile.BuyerGradeNum == 10 || Model.MyProfile.BuyerGradeNum == 20)
	{
		SVIP_OR_VIP = true;
	}

	DateTime nowTime = DateTime.Now;
	DateTime startTime = DateTime.Now;
	DateTime endTime = DateTime.Now;
}

	<!-- CONTENT -->
	<div id="content" class="ctns">		
		<div class="mkt">
			<div class="vip">
				<h3>SVIP/VIP 사은품</h3>

				<!-- 이달의 VIP최강혜택 -->
				<div class="mon_wrap" id="vip_ent">
					<div class="mon">
						<p class="txt">SVIP/VIP이면 누구나!<em>이달의 VIP최강혜택</em></p>
						<p class="prd">응모기간 : 매월 1일 오전 9시 ~ 20일</p>
						<ul>

                            @{    
								// nowTime = new DateTime(2013, 6, 1, 8, 0, 0, 0);

								startTime = new DateTime(nowTime.Year, nowTime.Month, 1, 9, 0, 0, 0);
								endTime = new DateTime(nowTime.Year, nowTime.Month, 20, 23, 59, 59, 0);


								foreach (JToken t in anyone_gift)
								{        
                                    @:<li>
                                    if (t["banner_text"].ToString().ToUpper().Equals("SVIP"))
									{
										/*if (PageAttr.IsLogin == false)
										{
											@:<a href="javascript:applyLogin();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
										}
										else if (DateTime.Now.Day > 20)
										{
											@:<a href="javascript:applyOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
										}
										else if (Model.MyProfile.BuyerGradeNum != 10)
										{
											@:<a href="javascript:applyGrade('SV');"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
										}
										else
										{
											@:<a href="javascript:CommonApplyEventPlatform(@Html.Raw(CreateEventCookie(t["eid"].ToString(), false)));"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>                        
										}*/
										if (PageAttr.IsLogin == false)
										{
                                            @:<a href="javascript:applyLogin();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                        }
										else if (Model.MyProfile.BuyerGradeNum != 10)
										{
                                            @:<a href="javascript:applyGrade('SV');"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                        }
										else
										{
											if (nowTime >= startTime && nowTime <= endTime)
											{
                                                @:<a href="javascript:CommonApplyEventPlatform(@Html.Raw(CreateEventCookie(t["eid"].ToString(), false)));"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>                        
                                            }
											else
											{
												if (nowTime.Day == startTime.Day)
												{
                                                    @:<a href="javascript:thisDayOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                                }
												else
												{                                  
                                                    @:<a href="javascript:applyOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                                }
											}
										}
									}
									else if (t["banner_text"].ToString().ToUpper().Equals("VIP"))
									{
										/*if (PageAttr.IsLogin == false)
										{
											@:<a href="javascript:applyLogin();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
										}
										else if (DateTime.Now.Day > 20)
										{
											@:<a href="javascript:applyOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
										}
										else if (Model.MyProfile.BuyerGradeNum != 20)
										{
											@:<a href="javascript:applyGrade('V');"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
										}
										else
										{
											@:<a href="javascript:CommonApplyEventPlatform(@Html.Raw(CreateEventCookie(t["eid"].ToString(), false)));"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>                        
										}*/
										if (PageAttr.IsLogin == false)
										{
                                            @:<a href="javascript:applyLogin();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                        }

										else if (Model.MyProfile.BuyerGradeNum != 20)
										{
                                            @:<a href="javascript:applyGrade('V');"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                        }
										else
										{
											if (nowTime > startTime && nowTime < endTime)
											{
                                                @:<a href="javascript:CommonApplyEventPlatform(@Html.Raw(CreateEventCookie(t["eid"].ToString(), false)));"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>                        
                                            }
											else
											{
												if (nowTime.Day == startTime.Day)
												{
                                                    @:<a href="javascript:thisDayOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                                }
												else
												{                                                
                                                    @:<a href="javascript:applyOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                                }
											}
										}
									}
									else
									{
										if (PageAttr.IsLogin == false)
										{
                                            @:<a href="javascript:applyLogin();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                        }

										else if (Model.MyProfile.BuyerGradeNum != 10 && Model.MyProfile.BuyerGradeNum != 20)
										{
                                            @:<a href="javascript:applyGrade('SVnV');"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                        }
										else
										{
											if (nowTime > startTime && nowTime < endTime)
											{
                                                @:<a href="javascript:CommonApplyEventPlatform(@Html.Raw(CreateEventCookie(t["eid"].ToString(), false)));"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>                        
                                            }
											else
											{
												if (nowTime.Day == startTime.Day)
												{
                                                    @:<a href="javascript:thisDayOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                                }
												else
												{                                                
                                                    @:<a href="javascript:applyOver();"><img src="@t["mobile_banner_url"]" alt="@t["banner_title"]" ></a>            
                                                }
											}
										}
									}
                                    @:</li>
                                }
                            }
						
						</ul>
					</div>
				</div>
				<!--//이달의 VIP최강혜택 -->

				<!-- VIP전용 구매금액별 사은품 -->
				<div class="pur_wrap" id="pur_wrap">
					<div class="pur">
						<p class="txt">구매 후엔 꼭! 받으세요~<em>VIP전용 구매금액별 사은품</em></p>
						<p class="prd">응모기간 : 매월 20일 오전 9시 ~ 말일</p>
@if (PageAttr.IsLogin == false)
{
						<!-- 구매현황 로그인전 -->
						<div class="now">
							<p class="conf1">로그인 하시면<br /><span>고객님의 구매현황 확인</span>하실 수 있습니다.</p>
							<a href="javascript:goLogin();" class="conf2">구매현황 확인하기</a>
						</div>
						<!-- //구매현황 로그인전 -->
}
else
{
						<!-- 구매현황 로그인후 -->
						<div class="now">
							<p class="user"><em>@Model.MyProfile.CustNm</em><span>님의 @(Model.ThisMonth)월 구매현황</span></p>
							<ul>
								<li>기간 : @(Model.ThisMonth)월 1일~@(Model.LastDay)일</li>
								<li>구매건수 : <span>@Model.TotalCount</span>건</li>
								<li>구매금액 : <span>@Model.TotalPrice</span>원</li>
							</ul>
						</div>
						<!-- 구매현황 로그인후 -->
}						

						<!-- 사은품 응모 -->
						<div class="ent_wrap">
							<p class="txt2">사은품 응모는 매일 1개상품/1회 가능합니다.<span>받고 싶은 선물을 확인 후 응모해주세요.</span></p>
							
                            @{    
                                
								//var amount5 = new int[] { 113535, 113537, 102268 };
								//var amount10 = new int[] { 102269, 102272, 102277 };
								//var amount15 = new int[] { 102271, 102275, 102276 };
								int amountIndex = 0;



								startTime = new DateTime(nowTime.Year, nowTime.Month, 20, 10, 0, 0, 0); // 이번달 20일 10시 기준  
                            } 
                                                                                           
                            @{
                                @:<div class="ent">
                                @:<p>5만원이상 <span>구매시</span></p>
                                @:<div id="bnWrap1" class="bn_grp"><ul id="bnList1">                                
                                
								//foreach (JToken t in amount_gift.Where(x => amount5.Contains(Convert.ToInt32(x["apply_eid"].ToString()))))
								foreach (JToken t in amount_gift.Where(x => (x["stype"].ToString().Equals("5"))))
								{
									if (nowTime > startTime)
									{
                                        @:<li><a href="javascript:applyEvent('@(amountIndex)');"><img src="@(t["mobile_banner_url"])" alt=""></a></li>
                                    }
									else
									{
                                        @:<li><a href="javascript:applyPreview();"><img src="@(t["mobile_banner_url"])" alt=""></a></li>                                        
                                    }

									amountIndex++;
								}
								@:</ul></div>
								@:<div id="bnTurn1" class="bn_turn">
								@:<a href="#" id="bnPrev1" class="prev"><span></span></a>
							    @:<a href="#" id="bnNext1" class="next"><span></span></a>
								@:</div>                                
                                @:</div>
                            
                            }
                            
		                    

                            @{
                                @:<div class="ent">
                                @:<p>10만원이상 <span>구매시</span></p>
                                @:<div id="bnWrap2" class="bn_grp"><ul id="bnList2">
                                
								//foreach (JToken t in amount_gift.Where(x => amount10.Contains(Convert.ToInt32(x["apply_eid"].ToString()))))
								foreach (JToken t in amount_gift.Where(x => (x["stype"].ToString().Equals("10"))))
								{
									if (nowTime > startTime)
									{
                                        @:<li><a href="javascript:applyEvent('@(amountIndex)');"><img src="@(t["mobile_banner_url"])" alt=""></a></li>
                                    }
									else
									{
                                        @:<li><a href="javascript:applyPreview();"><img src="@(t["mobile_banner_url"])" alt=""></a></li>                                        
                                    }

									amountIndex++;
								}
								@:</ul></div>
								@:<div id="bnTurn2" class="bn_turn">
								@:<a href="#" id="bnPrev2" class="prev"><span></span></a>
							    @:<a href="#" id="bnNext2" class="next"><span></span></a>
								@:</div>                                
                                @:</div>
                            }


                            @{
                                @:<div class="ent">
                                @:<p>15만원이상 <span>구매시</span></p>
                                @:<div id="bnWrap3" class="bn_grp"><ul id="bnList3">
                                //foreach (JToken t in amount_gift.Where(x => amount15.Contains(Convert.ToInt32(x["apply_eid"].ToString()))))
								foreach (JToken t in amount_gift.Where(x => (x["stype"].ToString().Equals("15"))))
								{
									if (nowTime > startTime)
									{
                                        @:<li><a href="javascript:applyEvent('@(amountIndex)');"><img src="@(t["mobile_banner_url"])" alt=""></a></li>
                                    }
									else
									{
                                        @:<li><a href="javascript:applyPreview();"><img src="@(t["mobile_banner_url"])" alt=""></a></li>                                        
                                    }

									amountIndex++;
								}
								@:</ul></div>
								@:<div id="bnTurn3" class="bn_turn">
								@:<a href="#" id="bnPrev3" class="prev"><span></span></a>
							    @:<a href="#" id="bnNext3" class="next"><span></span></a>
								@:</div>                                
                                @:</div>
                            }
						</div>
						<!-- //사은품 응모 -->

                        <form name="frmMain" method="post" action="VipEventApplyResult.asp">
                        <input type="hidden" name="event_num">
                        <input type="hidden" name="crossdomain" value="Y" />
                        </form>
                        <iframe src="about:blank" name="iFrmResult" id="iFrmResult" width="0" height="0" frameborder="0"></iframe>

						<!-- NOTICE -->
						<div class="notice">
							<p>NOTICE <span>꼭!확인하세요</span></p>
							<ul>
								<li>당첨자 발표는 이벤트 종료후 3~5일 사이에 공지됩니다.<br />(당첨자는 PC를 통해 확인하실수 있습니다.)</li>
								<li>당첨자는 대행사를 통해 개별연락되며, 개별연락후 1~2주 내<br />배송됩니다.</li>
								<li>사은품 발송은 고객님 응모 ID 회원정보에 등록된 주소/핸드폰번호로 발송되니 응모후에 꼭!회원정보를 확인해주세요.<br />(잘못된 정보로 발생하는 반품/분실은 책임지지 않습니다.)</li>
@if (DateTime.Now < new DateTime(2014, 4, 1, 0, 0, 0))
{
								<li>2013.11월~2014.1월 사은품 대행사 : 세그루 02-313-9070<br />2014.2월 사은품 대행사 : TNC코리아 031-941-1044<br />(사은품발송을 위해 이름/연락처/주소등이 대행사에 전달됩니다.)</li>
}
else
{
								<li>2월 사은품 대행사 : TNC코리아 031-941-1044<br />3월 사은품 대행사 : 클락워크 070-8118-9510<br />(사은품발송을 위해 이름/연락처/주소등이 대행사에 전달됩니다.)</li>
}
								<li>이벤트 진행사항은 당사사정으로 임의로 변결될수 있습니다.</li>
							</ul>
						</div>
						<!-- //NOTICE -->
					</div>
				</div>
				<!-- //VIP전용 구매금액별 사은품 -->

				<!-- VIP전용메일 신청하기 -->
				<div class="ask_wrap" style="display:none;">
					<p class="txt1"><span>지금!</span> VIP전용메일 신청하시면</p>
					<p class="txt2">G스탬프 3장 100%증정<br />매달 다양한 전용혜택을 드립니다!</p>
					<a href="javascript:setCheckEmail();" class="ask">메일신청</a>
				</div>
				<!-- //VIP전용메일 신청하기 -->

				<!-- VIP 멤버쉽 혜택안내 -->
				<div class="memb_wrap">
					<div class="memb">
						<a href="~/EventZone/MyBenefit" class="info"><img src="@Urls.MobileImageUrl/640/img_vip_ben.png" alt="VIP 멤버쉽 혜택안내" /></a>
						<div class="ben_wrap">
							<a href="#vip_ent" class="ben1">
								<span>VIP면 누구나<span>VIP전용 사은품</span></span>
							</a>
							<a href="tel:1566-5701" class="ben2">
								<span>빠르고 특별한<span>VIP전용 콜센터</span></span>
							</a>
							<a href="javascript:alertPC();" class="ben3">
								<span class="cult">최신영화가 공짜<span>VIP 문화혜택</span></span>
								<span class="auct">명품이 천원!<span>VIP 행운경매</span></span>
							</a>
						</div>
						<p>＊VIP문화혜택/행운경매는 PC웹에서 이용가능</p>
					</div>
				</div>
				<!-- //VIP 멤버쉽 혜택안내 -->
			</div>

            <!-- 이벤트/쿠폰/혜택 전체보기 (공통) -->
            <div class="mkt_all_wrap">
                <div class="mkt_all">
                    <p>
                        이벤트/쿠폰/혜택 <span class="all1">전체보기</span></p>
                    <a href="@Urls.MobileWebUrl/EventZone/MyBenefitHome" class="all2">모두보기</a>
                </div>
                <ul>
                    <li class="mkt_nav1"><a href="@Urls.MobileWebUrl/Pluszone">플러스존</a></li>
                    <li class="mkt_nav2"><a href="@Urls.MobileWebUrl/EventZone/MyBenefitCoupon">전회원할인</a></li>
                    <li class="mkt_nav3"><a href="@Urls.MobileWebUrl/EventZone/MyBenefit">등급혜택</a></li>
                    <li class="mkt_nav4"><a href="@Urls.MobileWebUrl/EventZone/MyBenefitVip">VIP사은품</a></li>
                    <li class="mkt_nav5"><a href="@Urls.MobileWebUrl/GStamp">G스탬프</a></li>
                </ul>
            </div>
            <!-- //이벤트/쿠폰/혜택 전체보기 (공통) -->
		</div>
	</div>
	<!-- //CONTENT -->

@section scripts 
{
<script type="text/javascript" src="@Url.Content("~/Scripts/jquery.touchwipe.min.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/EventZone.js")"></script>
<script type="text/javascript">
    $(document).ready(function () {
        // 
        $("#bnList1").touchwipe({ 
            wipeLeft: function() {  $("#bnNext1").click(); event.preventDefault(); },
            wipeRight: function() {  $("#bnPrev1").click(); event.preventDefault(); },
            preventDefaultEvents: false
        });

        //$("#bnList1").bind("touchstart", function () { roll1.stopTimer(); });
        //$("#bnList1").bind("touchend",function(){ roll1.startTimer(); });

        //
        $("#bnList2").touchwipe({ 
            wipeLeft: function() {  $("#bnNext2").click(); event.preventDefault(); },
            wipeRight: function() {  $("#bnPrev2").click(); event.preventDefault(); },
            preventDefaultEvents: false
        });

        //$("#bnList2").bind("touchstart", function () { roll2.stopTimer(); });
        //$("#bnList2").bind("touchend",function(){ roll2.startTimer(); });

        //
        $("#bnList3").touchwipe({ 
            wipeLeft: function() {  $("#bnNext3").click(); event.preventDefault(); },
            wipeRight: function() {  $("#bnPrev3").click(); event.preventDefault(); },
            preventDefaultEvents: false
        });

        //$("#bnList3").bind("touchstart", function () { roll3.stopTimer(); });
        //$("#bnList3").bind("touchend",function(){ roll3.startTimer(); });

    });

    window.onload = function () {
        setTimeout(function () {
            displayLayer("progress_icon", "none");
        }, 100);
    }

    function isLogin() {
@{
    if (PageAttr.IsLogin == false)
    {
        @:return false;
    }
    else
    {
        @:return true;
    }        
}
    }
    
    function goLogin() {
        document.location.href = "@Urls.LoginUrl";
    }

    function applyPreview() {
	    alert("VIP전용 구매사은품은 20일 오전10시부터 응모하실 수 있습니다.");
    }

    function applyOver() {
	    alert("이달의 이벤트는 종료되었습니다.\n다음달 이벤트는 1일부터 응모하실수 있습니다.");
    }

    function applyGrade(sGrade) {
    	if (sGrade == "SV") {
		    alert("SVIP고객만 응모하실수 있습니다.\n고객님의 등급을 확인해주세요.");
	    } else if (sGrade == "V") {
    		alert("VIP고객만 응모하실수 있습니다.\n고객님의 등급을 확인해주세요.");
	    }
    }

    function applyLogin() {
	    alert("이벤트에 응모하시려면 로그인을 하셔야 합니다.");
	    goLogin();
    }

    function applyEvent(amountIndex) {
	    if (!isLogin()) {
		    alert("이벤트에 응모하시려면 로그인을 하셔야 합니다.");
		    goLogin();
		    return;
	    } else {
            document.domain = 'gmarket.co.kr';

            @if (SVIP_OR_VIP)
            {
		        @:document.frmMain.event_num.value = amountIndex;
		        @:document.frmMain.action = NeverdiePromotionUrl + "/eventzone/VipEventApplyResult.asp";
		        @:document.frmMain.target = "iFrmResult";
		        @:document.frmMain.submit();
            }
            else
            {
                @:alert('이달의 쇼핑등급이 SVIP, VIP인 고객만 사은품받기가 가능합니다.\n고객님의 쇼핑등급을 확인해주세요!');        
	        }
        }
    }
    
    function setCheckEmail(){
	    if(!isLogin()) {
            alert('VIP전용메일을 신청하시려면 로그인을 하셔야 합니다.'); 
		    return;
	    }     
        
        @if (this.CheckEventApplyCount("2012-06-01 00:00:00", "113528", "118751", "", "") < 1)
        {

        }
        else
        {
            @:alert('이미 VIP전용메일을 신청 완료하셨습니다.');
            @:return;
        }

        @if (SVIP_OR_VIP)
        {
            @:VipCheckEmail();
        }
        else
        {
            @:alert('SVIP와 VIP고객만 이용하실 수 있습니다.');
        }   	  
    }
           
    function fnApply(str) {
	    str = str.replace(/'/gi,"");
	    str = str.replace(/ /gi,"");
	    var sArrstr = str.split(",");
    	CommonApplyEventPlatform(sArrstr[0], sArrstr[1]);
    }

    function alertPC() {
        alert('VIP문화혜택/행운경매는 PC웹에서 이용 가능합니다');
    }
    
    function thisDayOver() {
        alert('이달의 이벤트는 오전 9시부터 응모하실 수 있습니다.');
    }

	function VipCheckEmail() {
		$.ajax({
			type: 'POST',
			dataType: 'json',
			url: "@Url.Action("MyBenefitVip_CheckEmail", "EventZone")",
			success: function (result) {                             
				if (result.IsLogin) {
					if (result.AllowReceiveEmail){
						CommonApplyEventPlatform(@Html.Raw(this.CreateEventCookie("118751", false)));			            
					} else {
						alert('VIP전용메일을 신청하시려면 나의 고객정보를 통해 메일 받기 수신동의 하셔야 신청 가능합니다.');
						var win = window.open('about:blank');
						
						win.location = 'https://member.gmarket.co.kr/challenge/neo_my_gd/personal_check.asp';
					}                    
				} else {
					alert('로그인이 필요합니다.');
				}              
			},
			error: function (result) {
				alert('오류가 발생했습니다.');
			}
		});
	}
</script>


<script type="text/javascript">
//<![CDATA[
    var roll1 = new ImageRotation();
    roll1.objName = 'roll1';
    roll1.scrollDirection = 'direction';
    roll1.setScrollType('horizontal');
    roll1.autoScroll = "none"; 
    roll1.scrollGap = 5000;
    roll1.listNum = 1;
    roll1.wrapId = "bnWrap1";
    roll1.listId = "bnList1";
    roll1.btnNext = "bnNext1";
    roll1.btnPrev = "bnPrev1";
    //roll1.cntPage = "tPage1";
    //roll1.sRoll = "sRoll1";
    roll1.mg = 0;
    roll1.widthNoChange = "yes";
    roll1.initialize();
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
	var roll2 = new ImageRotation();
	roll2.objName = 'roll2';
	roll2.scrollDirection = 'direction';
	roll2.setScrollType('horizontal');
	roll2.autoScroll = "none";
	roll2.scrollGap = 4500;
	roll2.listNum = 1;
	roll2.wrapId = "bnWrap2";
	roll2.listId = "bnList2";
	roll2.btnNext = "bnNext2";
	roll2.btnPrev = "bnPrev2";
	//roll2.cntPage = "tPage1";
	//roll2.sRoll = "sRoll1";
	roll2.mg = 0;
	roll2.widthNoChange = "yes";
	roll2.initialize();
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
	var roll3 = new ImageRotation();
	roll3.objName = 'roll3';
	roll3.scrollDirection = 'direction';
	roll3.setScrollType('horizontal');
	roll3.autoScroll = "none";
	roll3.scrollGap = 4000;
	roll3.listNum = 1;
	roll3.wrapId = "bnWrap3";
	roll3.listId = "bnList3";
	roll3.btnNext = "bnNext3";
	roll3.btnPrev = "bnPrev3";
	//roll3.cntPage = "tPage3";
	//roll3.sRoll = "sRoll3";
	roll3.mg = 0;
	roll3.widthNoChange = "yes";
	roll3.initialize();
//]]>
</script>
}
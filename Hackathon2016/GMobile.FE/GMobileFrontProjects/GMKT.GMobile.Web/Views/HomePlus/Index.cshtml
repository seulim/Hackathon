@{
	Layout = "_HomePlusLayout.cshtml";
}
@model GMKT.GMobile.Data.HomePlus.HomePlusHomeT

<div class="mbanner_bx">
	<div class="scroll_wrap banner_wrap">
		<div id="bnGrp">
			<ul>
				@foreach(var i in Model.Banners)
				{
					<li><a href="@i.LinkUrl" onclick="javascript:SnaChannelCodeUrl('HPM0A005');">
					<img src="@i.ImagePath" alt="" /></a></li>
				}
			</ul>
		</div>
		<div id="bnTurn" class="bn_eturn">
			<button type="button" id="prev" class="prev" onclick="gallery1.prev();return false;">
				<span class="sp_hplus">이전</span></button>
			<button type="button" id="next" class="next" onclick="gallery1.next();return false;">
				<span class="sp_hplus">다음</span></button>
		</div>
		<div id="bnIndex2" class="bn_eindex"></div>
	</div>
	<script type="text/javascript">
		/* 이미지 높이값 고정 */
		$(window).on("resize", function () {
			setImgHeight();
		});
		function setImgHeight() {
			var $bnr_img = $('#bnGrp a img');
		}
		setImgHeight();
		/* //이미지 높이값 고정 */

		var gallery1, el, i, page, dots2;
		/* HTML 파싱 */
		var bnGrpList1 = $("#bnGrp li");
		if (1 < bnGrpList1.length) {
			var bnGrpListAtag1 = [];
			var $indicators = $("#bnIndex2");
			$indicators.html("");

			for (var j = 0; j < bnGrpList1.length; j++) {
				bnGrpListAtag1[j] = bnGrpList1[j].innerHTML;
				var indiHTML = "<span class='sp_hplus'><span class='blind'>" + (j + 1) + "</span></div>"
				$indicators.append($(indiHTML));
			}
			$indicators.find(".sp_hplus").eq(0).addClass("selected");
			dots2 = $indicators.find(".sp_hplus");
			var globalBnGrpListAtag1 = bnGrpListAtag1.join(",");

			/* //HTML 파싱 */

			gallery1 = new SwipeView('#bnGrp', {
				numberOfPages: bnGrpListAtag1.length,
				hastyPageFlip: true,
				flickTime: 1000
			});

			// Load initial data
			for (i = 0; i < 3; i++) {

				if (1 == bnGrpListAtag1.length) {
					page = i == 0 || 2 ? bnGrpListAtag1.length - 1 : i - 1;
				}
				else {
					page = i == 0 ? bnGrpListAtag1.length - 1 : i - 1;
				}
				el = document.createElement('span');
				el.innerHTML = bnGrpListAtag1[page];
				gallery1.masterPages[i].appendChild(el)

				el.width = bnGrpListAtag1[page].width;
				el.height = bnGrpListAtag1[page].height;
				el.onload = function () { this.className = ''; }
			}

			gallery1.onFlip(function () {
				var el,
                                upcoming,
                                i;

				for (i = 0; i < 3; i++) {
					upcoming = gallery1.masterPages[i].dataset.upcomingPageIndex;

					if (upcoming != gallery1.masterPages[i].dataset.pageIndex) {
						el = gallery1.masterPages[i].querySelector('span');
						el.innerHTML = bnGrpListAtag1[upcoming];
					}
				}
				document.querySelector('#bnIndex2 .selected').className = 'sp_hplus';
				dots2[gallery1.pageIndex].className = 'sp_hplus selected';

				setImgHeight();
			});

			flicking("bnGrp", "prev", "next");

		} else if (1 == bnGrpList1.length) {
			var bnGrpListAtag1 = [];

			for (var j = 0; j < bnGrpList1.length; j++) {
				bnGrpListAtag1[j] = bnGrpList1[j].innerHTML;
			}
			var globalBnGrpListAtag1 = bnGrpListAtag1.join(",");
			var elSpan = document.createElement('span');
			elSpan.innerHTML = globalBnGrpListAtag1;
			document.querySelector('#bnGrp').appendChild(elSpan);

			flicking("bnGrp", "prev", "next");
		}
	</script>
	<!-- [D] 카테고리 배너 -->
	<div class="banner_wrap2">
		<ul class="cate_slide">
		@for(int i = 0; i < Math.Ceiling((double)ViewBag.categoryList.Count / 10); i++)
		{
			<li>
				<ul class="items">
				@for(int j = i * 10; j < i * 10 + 10 && j < ViewBag.categoryList.Count; j++)
				{
					<li><a href="@(String.IsNullOrEmpty(ViewBag.categoryList[j].MobileURL) ? Url.Action("List", "HomePlus", new { shopCategory = ViewBag.categoryList[j].ShopCategoryCd }) : ViewBag.categoryList[j].MobileURL)" onclick="javascript:SnaChannelCodeUrl('HPM0A006');"><span class="item_img cate@(ViewBag.categoryList[j].DisplayAreaTypeValue)"></span><span class="name">@ViewBag.categoryList[j].ImageTitle</span></a></li>
				}
				</ul>
			</li>
		}
		</ul>
	</div>
	<!--// [D] 카테고리 배너 -->
</div>
@if(Model.Sections != null)
{
	if(Model.Sections.ContainsKey("1") && Model.Sections["1"].Items != null && Model.Sections["1"].Items.Count > 0)
	{
<div class="item_section">
	<h3 class="sub_tit first">
		<strong>@Model.Sections["1"].Title</strong>
		<span class="more_bx"><a href="@Url.Action("SpecialShop", "HomePlus", new { id = Model.Sections["1"].PageSeq })" onclick="javascript:SnaChannelCodeUrl('HPM0A007');">더보기</a></span>
	</h3>
	<ul class="item_bx">
		<li class="item">
			<a href="@Model.Sections["1"].Items[0].LinkURL" onclick="javascript:SnaChannelCodeUrl('HPM0A007');">
				<span class="thumb">
					<img src="@(String.IsNullOrEmpty(Model.Sections["1"].Items[0].ImageURL2) ? Model.Sections["1"].Items[0].ImageURL : Model.Sections["1"].Items[0].ImageURL2)" alt="@Model.Sections["1"].Items[0].GoodsName" />
				</span>
				<span class="item_tit">@Model.Sections["1"].Items[0].GoodsName</span>
				<span class="price">@Model.Sections["1"].Items[0].SalePrice</span>
			</a>
			@if(Model.Sections["1"].Items[0].OptSellDetailNonusePoint == 100)
			{
			<a href="#" onclick="SnaChannelCodeUrl('HPM0A007'); setCartLayer('@Model.Sections["1"].Items[0].GoodsName','@Model.Sections["1"].Items[0].SalePrice', '@Model.Sections["1"].Items[0].GoodsCode'); return false;" class="btn_cart">바로담기</a> 
			}
		</li>
	</ul>
</div>
	}
	if(Model.Sections.ContainsKey("2") && Model.Sections["2"].Items != null && Model.Sections["2"].Items.Count > 0)
	{
<div class="item_section">
	<h3 class="sub_tit first">
		<strong>@Model.Sections["2"].Title</strong>
		<span class="more_bx"><a href="@Url.Action("SpecialShop", "HomePlus", new { id = Model.Sections["2"].PageSeq })" onclick="javascript:SnaChannelCodeUrl('HPM0A007');">더보기</a></span>
	</h3>
	<ul class="item_bx">
		<li class="item">
			<a href="@Model.Sections["2"].Items[0].LinkURL" onclick="javascript:SnaChannelCodeUrl('HPM0A007');">
				<span class="thumb">
					<img src="@(String.IsNullOrEmpty(Model.Sections["2"].Items[0].ImageURL2) ? Model.Sections["2"].Items[0].ImageURL : Model.Sections["2"].Items[0].ImageURL2)" alt="@Model.Sections["2"].Items[0].GoodsName" />
				</span>
				<span class="item_tit">@Model.Sections["2"].Items[0].GoodsName</span>
				<span class="price">@Model.Sections["2"].Items[0].SalePrice</span>
			</a>
			@if(Model.Sections["2"].Items[0].OptSellDetailNonusePoint == 100)
	 {
			<a href="#" onclick="SnaChannelCodeUrl('HPM0A007'); setCartLayer('@Model.Sections["2"].Items[0].GoodsName','@Model.Sections["2"].Items[0].SalePrice', '@Model.Sections["2"].Items[0].GoodsCode'); return false;" class="btn_cart">바로담기</a>
	 }
		</li>
	</ul>
</div>
	}
	if(Model.Sections.ContainsKey("3") && Model.Sections["3"].Items != null && Model.Sections["3"].Items.Count > 0)
	{
<div class="item_section">
	<h3 class="sub_tit first">
		<strong>@Model.Sections["3"].Title</strong>
		<span class="more_bx"><a href="@Url.Action("SpecialShop", "HomePlus", new { id = Model.Sections["3"].PageSeq })" onclick="javascript:SnaChannelCodeUrl('HPM0A007');">더보기</a></span>
	</h3>
	<ul class="item_bx">
		<li class="item">
			<a href="@Model.Sections["3"].Items[0].LinkURL" onclick="javascript:SnaChannelCodeUrl('HPM0A007');">
				<span class="thumb">
					<img src="@(String.IsNullOrEmpty(Model.Sections["3"].Items[0].ImageURL2) ? Model.Sections["3"].Items[0].ImageURL : Model.Sections["3"].Items[0].ImageURL2)" alt="@Model.Sections["3"].Items[0].GoodsName" />
				</span>
				<span class="item_tit">@Model.Sections["3"].Items[0].GoodsName</span>
				<span class="price">@Model.Sections["3"].Items[0].SalePrice</span>
			</a>
			@if(Model.Sections["3"].Items[0].OptSellDetailNonusePoint == 100)
	 {
			<a href="#" onclick="SnaChannelCodeUrl('HPM0A007'); setCartLayer('@Model.Sections["3"].Items[0].GoodsName','@Model.Sections["3"].Items[0].SalePrice', '@Model.Sections["3"].Items[0].GoodsCode'); return false;" class="btn_cart">바로담기</a>
	 }
			</li>
	</ul>
</div>
	}
	if(Model.Sections.ContainsKey("4") && Model.Sections["4"].Items != null && Model.Sections["4"].Items.Count > 0)
	{
<div class="week_bx bg">
	<h3 class="sub_tit"><a href="@Url.Action("SpecialShop", "HomePlus", new { id = Model.Sections["4"].PageSeq })" onclick="javascript:SnaChannelCodeUrl('HPM0A008');"class="week">@Model.Sections["4"].Title</a></h3>
	<ul class="item_bx">
		@foreach(var i in Model.Sections["4"].Items)
	{
			<li class="item">
				<a href="@i.LinkURL">
					<span class="thumb">
						<img src="@i.ImageURL" alt="@i.GoodsName" />
					</span>
					<span class="item_tit">@i.GoodsName</span>
					<span class="price">@i.SalePrice</span>
					@if(!String.IsNullOrEmpty(i.Branch.Prmt1CdImageUrl))
		 {
					<span class="tag">
						<img src="@i.Branch.Prmt1CdImageUrl" alt="행사태그" />
					</span>	
		 }
				</a>
				@if(i.OptSellDetailNonusePoint == 100)
		{
				<a href="#" onclick="setCartLayer('@i.GoodsName','@i.SalePrice', '@i.GoodsCode'); return false;" class="btn_cart">바로담기</a>
		}
			</li>
	}
	</ul>
		@if(Model.ItemTotalSize > ViewBag.itemListSize)
	{
	<div class="see_more"><a href="#" onclick="moreItem(); return false;">상품 더 보기</a></div>	
	}
</div> 
	}
}

<script id="item-template" type="text/x-handlebars-template">
{{#each this}}
	<li class="item">
		<a href="{{LinkURL}}">
			<span class="thumb">
				<img src="{{ImageURL}}" alt="상품이미지 ">
			</span>
			<span class="item_tit">{{GoodsName}}</span> 
			<span class="price">{{SalePrice}}</span>
			{{#if Branch.Prmt1CdImageUrl}}
			<span class="tag"><img src="{{Branch.Prmt1CdImageUrl}}" alt="" /></span>
			{{/if}}
		</a>
		<a href="#" onclick="setCartLayer('{{GoodsName}}','{{SalePrice}}', '{{GoodsCode}}'); return false;" class="btn_cart">바로담기</a>
	</li>
{{/each}}
</script>

<script type="text/javascript">
	stuff.setMenuName('home');
	stuff.setIsLogin(@(PageAttr.IsLogin == false ? Html.Raw("false") : Html.Raw("true")));
	stuff.setHasBranchCode(@(ViewBag.hasBranchCode == false ? Html.Raw("false") : Html.Raw("true")));
	moreParameters.setItemListTotalSize(@(Model.ItemTotalSize));
	moreParameters.setPageSize(@(ViewBag.itemListSize));
	moreParameters.setArea('4');
</script>